// lib/seo/catalog.ts — единый источник категорий

import { CANONICAL_REGIONS, normalizeRegion, getCanonicalRegion } from './regions';

export { CANONICAL_REGIONS, normalizeRegion, getCanonicalRegion };

export const CATEGORIES = [
  { 
    slug: 'prozrachnye-rolstavni', 
    name: 'Прозрачные рольставни',
    nameShort: 'Прозрачные рольставни',
    subtitle: 'Поставщики, цены и контакты',
    seoIntro: 'Прозрачные рольставни из поликарбоната для бизнеса и дома'
  },
  { 
    slug: 'zashitnye-rolstavni', 
    name: 'Защитные рольставни',
    nameShort: 'Защитные рольставни',
    subtitle: 'Поставщики, цены и контакты',
    seoIntro: 'Защитные рольставни для магазинов и офисов'
  },
  { 
    slug: 'bezramnoe-osteklenie', 
    name: 'Безрамное остекление',
    nameShort: 'Безрамное остекление',
    subtitle: 'Поставщики, цены и контакты',
    seoIntro: 'Безрамное остекление веранд, террас и беседок'
  },
  { 
    slug: 'vorota', 
    name: 'Ворота',
    nameShort: 'Ворота',
    subtitle: 'Поставщики, цены и контакты',
    seoIntro: 'Автоматические и механические ворота'
  },
  { 
    slug: 'myagkie-okna', 
    name: 'Мягкие окна',
    nameShort: 'Мягкие окна',
    subtitle: 'Поставщики, цены и контакты',
    seoIntro: 'Мягкие окна из ПВХ для веранд и беседок'
  },
  { 
    slug: 'rolletnye-shkafy', 
    name: 'Роллетные шкафы',
    nameShort: 'Роллетные шкафы',
    subtitle: 'Поставщики, цены и контакты',
    seoIntro: 'Роллетные шкафы для парковок и подвалов'
  },
  { 
    slug: 'ofisnye-peregorodki', 
    name: 'Офисные перегородки',
    nameShort: 'Офисные перегородки',
    subtitle: 'Поставщики, цены и контакты',
    seoIntro: 'Офисные перегородки из стекла и алюминия'
  },
] as const;

export type CategorySlug = typeof CATEGORIES[number]['slug'];

// Re-export region types
export type { Region } from './regions';

// SEO Dictionary — фиксированные текста
const SEO_DICTIONARY: Record<string, { title: string; description: string; h1: string; h2: string[] }> = {
  // Главная
  'home': {
    title: 'СтройСейлс — каталог поставщиков остекления и рольставней',
    description: 'СтройСейлс — каталог проверенных поставщиков прозрачных и защитных рольставней, ворот, безрамного остекления и офисных перегородок. Контакты компаний, прямые сайты и актуальные предложения в одном месте.',
    h1: 'Каталог проверенных поставщиков остекления',
    h2: ['Популярные категории', 'Как работает каталог СтройСейлс']
  },
  // Категории
  'prozrachnye-rolstavni': {
    title: 'Прозрачные рольставни — поставщики и цены | СтройСейлс',
    description: 'Каталог поставщиков прозрачных рольставней для террас, веранд и беседок. Сайты компаний, контакты и предложения производителей. Подберите подрядчика для монтажа в вашем регионе.',
    h1: 'Прозрачные рольставни — каталог поставщиков',
    h2: ['Рекомендуемые поставщики', 'Как выбрать подрядчика для прозрачных рольставней']
  },
  'zashitnye-rolstavni': {
    title: 'Защитные рольставни — поставщики и монтаж',
    description: 'Каталог компаний по установке защитных и антивандальных рольставней. Контакты производителей, прямые сайты и предложения по монтажу в вашем регионе.',
    h1: 'Защитные рольставни — каталог поставщиков',
    h2: ['Рекомендуемые компании', 'Как выбрать защитные рольставни']
  },
  'vorota': {
    title: 'Ворота откатные и секционные — поставщики',
    description: 'Каталог поставщиков откатных, секционных и автоматических ворот. Контакты компаний, сайты производителей и предложения по установке и обслуживанию.',
    h1: 'Поставщики откатных и секционных ворот',
    h2: ['Рекомендуемые компании', 'Монтаж и автоматизация ворот']
  },
  'bezramnoe-osteklenie': {
    title: 'Безрамное остекление — поставщики и цены',
    description: 'Компании по безрамному остеклению террас, веранд и фасадов. Сайты производителей, контакты подрядчиков и предложения по монтажу конструкций.',
    h1: 'Поставщики безрамного остекления',
    h2: ['Рекомендуемые компании', 'Виды безрамного остекления']
  },
  'ofisnye-peregorodki': {
    title: 'Офисные перегородки — поставщики в каталоге',
    description: 'Каталог компаний по изготовлению и установке офисных перегородок. Контакты производителей, сайты подрядчиков и решения для зонирования пространства.',
    h1: 'Поставщики офисных перегородок',
    h2: ['Рекомендуемые компании', 'Типы офисных перегородок']
  },
  'rolletnye-shkafy': {
    title: 'Роллетные шкафы — производители и поставщики',
    description: 'Компании по производству и продаже роллетных шкафов и боксов. Контакты поставщиков, официальные сайты и предложения для парковок и балконов.',
    h1: 'Поставщики роллетных шкафов',
    h2: ['Рекомендуемые производители', 'Где применяются роллетные шкафы']
  },
  'myagkie-okna': {
    title: 'Мягкие окна — поставщики и цены | СтройСейлс',
    description: 'Каталог поставщиков мягких окон из ПВХ для террас, веранд и беседок. Контакты компаний, сайты производителей и предложения по установке.',
    h1: 'Мягкие окна — каталог поставщиков',
    h2: ['Рекомендуемые поставщики', 'Как выбрать мягкие окна']
  },
  // Регионы (шаблоны)
  'prozrachnye-rolstavni-moskva-i-mo': {
    title: 'Прозрачные рольставни в Москве и МО — поставщики',
    description: 'Поставщики прозрачных рольставней в Москве и Московской области. Сравните компании, перейдите на официальный сайт или свяжитесь напрямую для расчёта стоимости и монтажа.',
    h1: 'Прозрачные рольставни в Москве и МО',
    h2: ['Рекомендуемые поставщики в регионе', 'Все компании Москвы и области']
  },
};

// Generate metadata for category page
export function getCategoryMetadata(slug: CategorySlug) {
  const dict = SEO_DICTIONARY[slug];
  if (!dict) return null;
  
  return {
    title: dict.title,
    description: dict.description,
    h1: dict.h1,
    h2: dict.h2,
  };
}

// Generate metadata for category+region page
export function getCategoryRegionMetadata(categorySlug: CategorySlug, regionSlug: string) {
  const cat = CATEGORIES.find(c => c.slug === categorySlug);
  const region = getCanonicalRegion(regionSlug);
  
  if (!cat || !region) return null;
  
  // Проверяем точное совпадение в словаре
  const dictKey = `${categorySlug}-${regionSlug}`;
  const dict = SEO_DICTIONARY[dictKey];
  
  if (dict) {
    return {
      title: dict.title,
      description: dict.description,
      h1: dict.h1,
      h2: dict.h2,
    };
  }
  
  // Fallback для других регионов (не должно использоваться для Москвы)
  return {
    title: `${cat.name} в ${region.name} — цены, поставщики, отзывы | СтройСейлс`,
    description: `Найдите поставщиков ${cat.name.toLowerCase()} в ${region.name}. Реальные цены, отзывы, контакты.`,
    h1: `${cat.name} в ${region.name}`,
    h2: ['Рекомендуемые поставщики в регионе', 'Все компании'],
  };
}

// Get home page SEO
export function getHomeMetadata() {
  return SEO_DICTIONARY['home'];
}

// Get calculator page SEO  
export function getCalculatorMetadata() {
  return {
    title: 'Калькулятор стоимости рольставней онлайн',
    description: 'Онлайн-калькулятор прозрачных рольставней StekloRoll. Рассчитайте стоимость с учётом размеров, типа привода и комплектации. Цена включает монтаж и доставку.',
    h1: 'Калькулятор прозрачных рольставней',
    h2: ['Как рассчитывается стоимость', 'Что влияет на итоговую цену']
  };
}
